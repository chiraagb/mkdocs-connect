{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Aviara Connect Backend API Documentation","text":"<p>Welcome to the Aviara Connect Backend API Documentation. Aviara Connect is an AI-powered Knowledge Partner that streamlines knowledge management, boosts productivity, and empowers teams across industries.</p>"},{"location":"#what-is-aviara-connect","title":"What is Aviara Connect?","text":"<p>Aviara Connect is more than just a tool \u2013 it's your team's go-to solution for:</p> <ul> <li>Instant Access to Information: From company policies to operational guidelines, get accurate answers in real-time</li> <li>Knowledge Centralization: Organize resources in one secure location, including documents, URLs, and presentations</li> <li>Seamless Scalability: Handle up to 10,000 queries daily with ease and reliability</li> <li>Customizable and Secure: Hosted on Azure for top-tier security and flexible admin features</li> </ul>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Real-time AI Search: Retrieve relevant data in 2 seconds</li> <li>Multi-source Integration: Connect documents, CRM data, and cloud files</li> <li>Enterprise Security: Azure-hosted with enterprise-grade security</li> <li>Scalable Architecture: Designed to handle high-volume queries</li> <li>Team Collaboration: Enable faster decision-making across teams</li> </ul>"},{"location":"compliance/Contracts/","title":"Contracts","text":""},{"location":"compliance/Contracts/#overview","title":"Overview","text":"<p>The Contracts API provides endpoints for managing contracts within an organization, including uploading files, processing contract data, retrieving contract details, and deleting contracts.</p>"},{"location":"compliance/Contracts/#base-url","title":"Base URL","text":"<p>All endpoints are prefixed with <code>compliances/</code></p>"},{"location":"compliance/Contracts/#authentication","title":"Authentication","text":"<p>All endpoints require authentication. Include your authentication token in the request headers:</p> <pre><code>Authorization: Bearer\n</code></pre>"},{"location":"compliance/Contracts/#endpoints","title":"Endpoints","text":""},{"location":"compliance/Contracts/#1-get-all-contracts","title":"1. Get All Contracts","text":"<p>Retrieve a paginated list of all contracts for the authenticated user's organization.</p> <p>Endpoint: <code>GET /contracts/</code></p> <p>Parameters:</p> <ul> <li><code>page</code> (optional): Page number (default: 1)</li> <li><code>page_size</code> (optional): Number of contracts per page (default: 15)</li> </ul> <p>Response:</p> <pre><code>{\n  \"contracts\": [\n    {\n      \"_id\": \"contract_id\",\n      \"created_at\": \"2023-08-13T19:00:00Z\",\n      \"updated_at\": \"2023-08-13T19:00:00Z\"\n      // ... other contract fields\n    }\n  ],\n  \"total_count\": 100,\n  \"total_pages\": 7,\n  \"current_page\": 1,\n  \"page_size\": 15\n}\n</code></pre> <p>Status Codes:</p> <ul> <li><code>200 OK</code>: Successfully retrieved contracts</li> <li><code>401 Unauthorized</code>: Authentication required</li> </ul>"},{"location":"compliance/Contracts/#2-get-contract-details","title":"2. Get Contract Details","text":"<p>Retrieve detailed information for a specific contract including AI insights, compliance status, and violations.</p> <p>Endpoint: <code>GET /contracts/detail/{contract_id}/</code></p> <p>Parameters:</p> <ul> <li><code>contract_id</code> (path): MongoDB ObjectId of the contract</li> </ul> <p>Response:</p> <pre><code>{\n  \"contract\": {\n    \"_id\": \"contract_id\",\n    \"ai_insights\": {...},\n    \"is_compliant\": true,\n    \"violations\": [],\n    \"created_at\": \"2023-08-13T19:00:00Z\",\n    \"updated_at\": \"2023-08-13T19:00:00Z\",\n    // ... other contract fields\n  }\n}\n</code></pre> <p>Status Codes:</p> <ul> <li><code>200 OK</code>: Contract found and returned</li> <li><code>404 Not Found</code>: Contract not found</li> <li><code>401 Unauthorized</code>: Authentication required</li> </ul>"},{"location":"compliance/Contracts/#3-upload-contract-files","title":"3. Upload Contract Files","text":"<p>Upload contract files for processing.</p> <p>Endpoint: <code>POST /contracts/files/</code></p> <p>Content-Type: <code>multipart/form-data</code></p> <p>Parameters:</p> <ul> <li><code>files</code> (form-data): Array of contract files to upload</li> </ul> <p>Response:</p> <pre><code>{\n  \"message\": \"Contract processing has started.\",\n  \"task_id\": \"uuid-task-id\"\n}\n</code></pre> <p>Status Codes:</p> <ul> <li><code>202 Accepted</code>: File upload initiated successfully</li> <li><code>400 Bad Request</code>: No files were uploaded</li> <li><code>401 Unauthorized</code>: Authentication required</li> </ul>"},{"location":"compliance/Contracts/#4-submit-contract-json","title":"4. Submit Contract JSON","text":"<p>Submit contract data in JSON format for processing.</p> <p>Endpoint: <code>POST /contracts/json/</code></p> <p>Content-Type: <code>application/json</code></p> <p>Request Body:</p> <pre><code>{\n  \"contract_json\": {\n    // Contract data in JSON format\n    \"title\": \"Contract Title\",\n    \"parties\": [...],\n    \"terms\": {...},\n    // ... other contract fields\n  }\n}\n</code></pre> <p>Response:</p> <pre><code>{\n  \"message\": \"Contract processing has started.\",\n  \"task_id\": \"uuid-task-id\"\n}\n</code></pre> <p>Status Codes:</p> <ul> <li><code>202 Accepted</code>: JSON processing initiated successfully</li> <li><code>400 Bad Request</code>: No contract_json provided or invalid input_type</li> <li><code>401 Unauthorized</code>: Authentication required</li> </ul>"},{"location":"compliance/Contracts/#5-update-contract-details","title":"5. Update Contract Details","text":"<p>Update specific fields of an existing contract.</p> <p>Endpoint: <code>PATCH /contracts/json/{mongo_id}/</code></p> <p>Content-Type: <code>application/json</code></p> <p>Parameters:</p> <ul> <li><code>mongo_id</code> (path): MongoDB ObjectId of the contract to update</li> </ul> <p>Request Body:</p> <pre><code>{\n  \"customer\": {\n    \"name\": \"Updated Customer Name\",\n    \"type\": \"Company\"\n  },\n  \"title\": \"Updated Contract Title\"\n  // ... other fields to update\n}\n</code></pre> <p>Response:</p> <pre><code>{\n  \"_id\": \"mongo_id\",\n  \"message\": \"Contract updated successfully.\",\n  \"updated_contract\": {\n    \"_id\": \"mongo_id\",\n    \"updated_at\": \"2023-08-13T19:00:00Z\"\n    // ... complete updated contract data\n  }\n}\n</code></pre> <p>Status Codes:</p> <ul> <li><code>200 OK</code>: Contract updated successfully</li> <li><code>400 Bad Request</code>: Contract ID required or invalid request body</li> <li><code>404 Not Found</code>: Contract not found</li> <li><code>401 Unauthorized</code>: Authentication required</li> </ul>"},{"location":"compliance/Contracts/#6-check-contract-processing-status","title":"6. Check Contract Processing Status","text":"<p>Check the status of a contract processing task.</p> <p>Endpoint: <code>GET /contract-upload-status/{task_id}/</code></p> <p>Parameters:</p> <ul> <li><code>task_id</code> (path): UUID of the processing task</li> </ul> <p>Response:</p> <pre><code>{\n  \"state\": \"SUCCESS\",\n  \"meta\": {\n    // Task metadata\n  },\n  \"message\": \"Contract processed successfully.\"\n}\n</code></pre> <p>Possible States:</p> <ul> <li><code>PENDING</code>: Task is waiting to be processed</li> <li><code>PROCESSING</code>: Task is currently being processed</li> <li><code>SUCCESS</code>: Task completed successfully</li> <li><code>FAILED</code>: Task failed to complete</li> </ul> <p>Status Codes:</p> <ul> <li><code>200 OK</code>: Status retrieved successfully</li> <li><code>401 Unauthorized</code>: Authentication required</li> </ul>"},{"location":"compliance/Contracts/#7-delete-contracts","title":"7. Delete Contracts","text":"<p>Delete multiple contracts from both the database and Azure Storage.</p> <p>Endpoint: <code>POST /contracts/delete/</code></p> <p>Content-Type: <code>application/json</code></p> <p>Request Body:</p> <pre><code>{\n  \"contract_ids\": [\"contract_id_1\", \"contract_id_2\", \"contract_id_3\"]\n}\n</code></pre> <p>Response:</p> <pre><code>{\n  \"message\": \"3 contract(s) deleted from the database. 2 corresponding file(s) deleted from Azure Storage.\"\n}\n</code></pre> <p>Status Codes:</p> <ul> <li><code>200 OK</code>: Contracts deleted successfully</li> <li><code>400 Bad Request</code>: No contract IDs provided</li> <li><code>404 Not Found</code>: No matching contracts found to delete</li> <li><code>401 Unauthorized</code>: Authentication required</li> </ul>"},{"location":"compliance/Contracts/#error-responses","title":"Error Responses","text":"<p>All endpoints may return the following error responses:</p> <p>401 Unauthorized:</p> <pre><code>{\n  \"detail\": \"Authentication credentials were not provided.\"\n}\n</code></pre> <p>400 Bad Request:</p> <pre><code>{\n  \"error\": \"Detailed error message\"\n}\n</code></pre> <p>404 Not Found:</p> <pre><code>{\n  \"error\": \"Resource not found\"\n}\n</code></pre> <p>500 Internal Server Error:</p> <pre><code>{\n  \"error\": \"An internal server error occurred\"\n}\n</code></pre>"},{"location":"compliance/Rules-Contract/","title":"Rules Contract","text":""},{"location":"compliance/Rules-Contract/#1-text-based-compliance-rules","title":"1. Text-Based Compliance Rules","text":""},{"location":"compliance/Rules-Contract/#endpoint","title":"Endpoint","text":"<p><code>POST /rules/text/</code> <code>GET /rules/text/</code></p>"},{"location":"compliance/Rules-Contract/#authentication","title":"Authentication","text":"<p>Required (<code>IsAuthenticated</code>)</p>"},{"location":"compliance/Rules-Contract/#post-rulestext-save-or-update-compliance-rules","title":"<code>POST /rules/text/</code> \u2014 Save or Update Compliance Rules","text":"<p>Purpose Allows an authenticated user to submit or update compliance rules in plain text format.</p> <p>Request Body</p> <pre><code>{\n  \"compliance_rules\": \"All invoices must be submitted within 7 days of contract execution.\"\n}\n</code></pre> <p>Responses</p> <ul> <li><code>200 OK</code> \u2013 Success</li> </ul> <pre><code>{\n  \"message\": \"Compliance rules updated successfully.\"\n}\n</code></pre> <ul> <li><code>400 Bad Request</code> \u2013 Missing rules</li> </ul> <pre><code>{\n  \"error\": \"Compliance rules are required.\"\n}\n</code></pre> <ul> <li><code>500 Internal Server Error</code> \u2013 Server failure</li> </ul> <pre><code>{\n  \"error\": \"Exception message\"\n}\n</code></pre>"},{"location":"compliance/Rules-Contract/#get-rulestext-retrieve-saved-compliance-rules","title":"<code>GET /rules/text/</code> \u2014 Retrieve Saved Compliance Rules","text":"<p>Purpose Fetch the current user's saved compliance rules, if available.</p> <p>Responses</p> <ul> <li><code>200 OK</code> \u2013 Rules found</li> </ul> <pre><code>{\n  \"compliance_rules\": \"All invoices must be submitted within 7 days of contract execution.\"\n}\n</code></pre> <ul> <li><code>404 Not Found</code> \u2013 No rules saved</li> </ul> <pre><code>{\n  \"compliance_rules\": \"\"\n}\n</code></pre> <ul> <li><code>500 Internal Server Error</code> \u2013 Server failure</li> </ul> <pre><code>{\n  \"error\": \"Exception message\"\n}\n</code></pre>"},{"location":"compliance/Rules-Contract/#2-file-based-compliance-rules","title":"2. File-Based Compliance Rules","text":""},{"location":"compliance/Rules-Contract/#endpoint_1","title":"Endpoint","text":"<p><code>POST /rules/files/</code> <code>GET /rules/files/</code> <code>PATCH /rules/files/&lt;file_id&gt;/</code></p>"},{"location":"compliance/Rules-Contract/#authentication_1","title":"Authentication","text":"<p>Required (<code>IsAuthenticated</code>)</p>"},{"location":"compliance/Rules-Contract/#post-rulesfiles-upload-compliance-rule-files","title":"<code>POST /rules/files/</code> \u2014 Upload Compliance Rule Files","text":"<p>Purpose Upload one or more rule documents (PDF, DOCX) and extract their text content for compliance processing.</p> <p>Accepted MIME Types</p> MIME Type Label application/pdf pdf application/msword word application/vnd.openxmlformats-officedocument.wordprocessingml.document word <p>Request Format <code>multipart/form-data</code></p> <p>Request Example</p> <pre><code>files: [&lt;file1&gt;, &lt;file2&gt;, ...]\n</code></pre> <p>Success Response (<code>201 Created</code>)</p> <pre><code>{\n  \"message\": \"Files uploaded successfully.\",\n  \"files\": [\n    {\n      \"id\": 101,\n      \"file_name\": \"compliance_rules.pdf\",\n      \"file_type\": \"pdf\",\n      \"file_content\": \"Extracted content from PDF...\",\n      \"url\": \"/media/compliance_files/compliance_rules.pdf\"\n    }\n  ]\n}\n</code></pre> <p>Error Response (<code>400 Bad Request</code>)</p> <pre><code>{\n  \"error\": \"No files were uploaded.\"\n}\n</code></pre>"},{"location":"compliance/Rules-Contract/#get-rulesfiles-list-uploaded-rule-files","title":"<code>GET /rules/files/</code> \u2014 List Uploaded Rule Files","text":"<p>Purpose Paginate through the list of uploaded compliance rule documents for the current user.</p> <p>Query Parameters</p> Parameter Type Default Description page int 1 Page number page_size int 15 Number of items/page <p>Success Response</p> <pre><code>{\n  \"files\": [\n    {\n      \"id\": 101,\n      \"file_name\": \"compliance_rules.pdf\",\n      \"file_type\": \"pdf\",\n      \"url\": \"/media/compliance_files/compliance_rules.pdf\",\n      \"created_at\": \"2025-06-24T13:00:00Z\"\n    }\n  ],\n  \"total_count\": 5,\n  \"total_pages\": 1,\n  \"current_page\": 1,\n  \"page_size\": 15\n}\n</code></pre>"},{"location":"compliance/Rules-Contract/#patch-rulesfilesfile_id-rename-an-uploaded-file","title":"<code>PATCH /rules/files/&lt;file_id&gt;/</code> \u2014 Rename an Uploaded File","text":"<p>Purpose Update the name of a previously uploaded file.</p> <p>Request Body</p> <pre><code>{\n  \"new_file_name\": \"updated_rules.pdf\"\n}\n</code></pre> <p>Success Response</p> <pre><code>{\n  \"message\": \"File renamed successfully.\",\n  \"id\": 101,\n  \"new_file_name\": \"updated_rules.pdf\"\n}\n</code></pre> <p>Error Responses</p> <ul> <li>Missing name</li> </ul> <pre><code>{\n  \"error\": \"New file name is required.\"\n}\n</code></pre> <ul> <li>File not found</li> </ul> <pre><code>{\n  \"error\": \"File not found.\"\n}\n</code></pre>"},{"location":"compliance/Rules-Contract/#summary","title":"Summary","text":"Endpoint Method Description <code>/rules/text/</code> GET Fetch text compliance rules <code>/rules/text/</code> POST Save or update text rules <code>/rules/files/</code> GET List uploaded rule files <code>/rules/files/</code> POST Upload compliance rule files <code>/rules/files/&lt;file_id&gt;/</code> PATCH Rename a rule file by ID"},{"location":"draft_contracts/01_upload/","title":"Upload Template API","text":""},{"location":"draft_contracts/01_upload/#post-apiv1draftingcontracttemplateupload","title":"POST <code>/api/v1/drafting/contract/template/upload/</code>","text":"<p>Upload a template in PDF format to the system. The API performss:</p> <ul> <li>Organization validation</li> <li>Duplicate detection using MD5 hash + filename/size fallback</li> <li>Gemini processing to extract HTML with variable placeholders</li> <li>Upload to Azure Blob Storage</li> <li>Save record in MongoDB</li> </ul>"},{"location":"draft_contracts/01_upload/#permissions","title":"Permissions","text":"Requirement Value Authentication Required Permission Class <code>IsAuthenticated</code>"},{"location":"draft_contracts/01_upload/#description","title":"Description","text":"<p>This endpoint allows an authenticated user to upload a contract template PDF. The system:</p> <ol> <li>Reads the file &amp; computes MD5 hash</li> <li>Checks MongoDB for duplicate templates</li> <li>If duplicate \u2192 returns <code>409 CONFLICT</code></li> <li>If new \u2192 sends the file to Gemini for HTML extraction</li> <li>Uploads the file to Azure Blob Storage</li> <li>Saves metadata + extracted HTML in MongoDB</li> <li>Returns template ID + HTML content + file URL</li> </ol>"},{"location":"draft_contracts/01_upload/#request","title":"Request","text":""},{"location":"draft_contracts/01_upload/#headers","title":"Headers","text":"Key Value Authorization <code>Bearer &lt;token&gt;</code> Content-Type <code>multipart/form-data</code>"},{"location":"draft_contracts/01_upload/#form-data-fields","title":"Form Data Fields","text":"Field Type Required Description <code>name</code> string Yes Template name <code>type</code> string Yes Template type/category <code>description</code> string No Brief description <code>files</code> file[] Yes One or more PDF files (only the first is processed)"},{"location":"draft_contracts/01_upload/#response-success-201","title":"Response (Success \u2013 201)","text":"<pre><code>{\n  \"message\": \"Template uploaded, processed, saved, and uploaded to Azure successfully.\",\n  \"template_id\": \"69291e28f5e5c1fd74b48165\",\n  \"html_content\": \"&lt;h1&gt;Sales Agreement&lt;/h1&gt; ...\",\n  \"file_url\": \"https://aviaraconnectstorage.blob.core.windows.net/aviara-connect/drafting_templates/sales_contract.pdf\"\n}\n</code></pre>"},{"location":"draft_contracts/01_upload/#response-duplicate-409","title":"Response (Duplicate \u2013 409)","text":"<pre><code>{\n  \"message\": \"Duplicate template detected.\",\n  \"template_id\": \"69291e28f5e5c1fd74b48165\",\n  \"file_url\": \"https://.../drafting_templates/sales_contract.pdf\"\n}\n</code></pre>"},{"location":"draft_contracts/01_upload/#response-validation-error-400","title":"Response (Validation Error \u2013 400)","text":"<pre><code>{ \"error\": \"No files were uploaded.\" }\n</code></pre> <p>OR</p> <pre><code>{ \"error\": \"User organization not found.\" }\n</code></pre>"},{"location":"draft_contracts/01_upload/#response-server-error-500","title":"Response (Server Error \u2013 500)","text":"<pre><code>{ \"error\": \"Failed to process file with Gemini API.\" }\n</code></pre>"},{"location":"draft_contracts/01_upload/#curl-example","title":"cURL Example","text":"<pre><code>curl -X POST \"https://your-domain.com/api/v1/drafting/contract/template/upload/\" \\\n  -H \"Authorization: Bearer &lt;TOKEN&gt;\" \\\n  -F \"name=Sales Agreement\" \\\n  -F \"type=Sales/Purchase Agreement\" \\\n  -F \"description=Testing upload\" \\\n  -F \"files=@/path/to/sales_contract.pdf\"\n</code></pre>"},{"location":"draft_contracts/01_upload/#python-example-requests","title":"Python Example (requests)","text":"<pre><code>import requests\n\nurl = \"https://your-domain.com/api/v1/drafting/contract/template/upload/\"\ntoken = \"&lt;TOKEN&gt;\"\n\nfiles = {\n    \"files\": open(\"sales_contract.pdf\", \"rb\")\n}\ndata = {\n    \"name\": \"Sales Agreement\",\n    \"type\": \"Sales/Purchase Agreement\",\n    \"description\": \"Testing upload\"\n}\n\nresp = requests.post(\n    url,\n    headers={\"Authorization\": f\"Bearer {token}\"},\n    data=data,\n    files=files\n)\n\nprint(resp.status_code)\nprint(resp.json())\n</code></pre>"},{"location":"draft_contracts/01_upload/#notes","title":"Notes","text":"<p>!!! info \"Important Notes\"</p> <ul> <li>Only the first file from <code>files[]</code> is processed.</li> <li>Duplicate detection uses MD5 hash, then fallback to (filename + size).</li> <li>File is uploaded to Azure Blob Storage under <code>drafting_templates/&lt;filename&gt;</code>.</li> <li>The extracted HTML is generated by the Gemini API using a fixed placeholder variable list.</li> <li>The actual MongoDB document structure depends on your database configuration.</li> </ul>"},{"location":"draft_contracts/02_list_templates/","title":"List Templates with search by name and filter by type","text":""},{"location":"draft_contracts/02_list_templates/#get-apiv1draftingcontracttemplate","title":"GET /api/v1/drafting/contract/template/","text":""},{"location":"draft_contracts/02_list_templates/#method","title":"Method","text":"<p><code>GET</code></p>"},{"location":"draft_contracts/02_list_templates/#auth","title":"Auth","text":"<p>Requires Bearer Token (IsAuthenticated).</p>"},{"location":"draft_contracts/02_list_templates/#query-params-optional","title":"Query Params (optional)","text":"Param Description <code>type</code> Filter by template type. <code>search</code> Case-insensitive search in template <code>name</code>."},{"location":"draft_contracts/02_list_templates/#success-response-200-ok","title":"Success Response \u2013 200 OK","text":"<pre><code>{\n  \"templates\": [\n    {\n      \"id\": \"string\",\n      \"name\": \"string\",\n      \"description\": \"string\",\n      \"type\": \"string\",\n      \"file_name\": \"string\",\n      \"file_url\": \"string\"\n    }\n  ]\n}\n</code></pre>"},{"location":"draft_contracts/02_list_templates/#error-responses","title":"Error Responses","text":""},{"location":"draft_contracts/02_list_templates/#400-no-organization","title":"400 \u2013 No Organization","text":"<pre><code>{ \"error\": \"User organization not found.\" }\n</code></pre>"},{"location":"draft_contracts/02_list_templates/#500-server-mongo-error","title":"500 \u2013 Server / Mongo Error","text":"<pre><code>{ \"error\": \"Failed to fetch templates.\" }\n</code></pre>"},{"location":"draft_contracts/03_delete_templates/","title":"Delete Templates API","text":""},{"location":"draft_contracts/03_delete_templates/#post-apiv1draftingcontracttemplatedelete","title":"POST <code>/api/v1/drafting/contract/template/delete/</code>","text":""},{"location":"draft_contracts/03_delete_templates/#auth","title":"Auth","text":"<p>Requires Bearer Token.</p>"},{"location":"draft_contracts/03_delete_templates/#body","title":"Body","text":"<pre><code>{\n  \"template_ids\": [\"string\", \"string\"]\n}\n</code></pre>"},{"location":"draft_contracts/03_delete_templates/#success-response-200-ok","title":"Success Response \u2014 200 OK","text":"<pre><code>{\n  \"message\": \"X template(s) deleted from the database. Y corresponding file(s) deleted from Azure Storage.\"\n}\n</code></pre>"},{"location":"draft_contracts/03_delete_templates/#error-responses","title":"Error Responses","text":""},{"location":"draft_contracts/03_delete_templates/#400-missing-org-or-ids","title":"400 \u2014 Missing org or IDs","text":"<pre><code>{ \"error\": \"User organization not found.\" }\n</code></pre> <pre><code>{ \"error\": \"No template IDs provided.\" }\n</code></pre>"},{"location":"draft_contracts/03_delete_templates/#404-ids-not-found","title":"404 \u2014 IDs not found","text":"<pre><code>{ \"error\": \"No matching templates found to delete.\" }\n</code></pre>"},{"location":"draft_contracts/03_delete_templates/#500-unexpected-errors","title":"500 \u2014 Unexpected errors","text":"<p>(Not explicitly returned except for Azure/Mongo logs; API returns 200 unless DB deletion count is zero.)</p>"},{"location":"draft_contracts/04_generate_draft/","title":"GenerateDraftView","text":""},{"location":"draft_contracts/04_generate_draft/#endpoint","title":"Endpoint","text":"<p>POST <code>api/v1/drafting/contract/generate-draft/</code></p>"},{"location":"draft_contracts/04_generate_draft/#auth","title":"Auth","text":"<p>Requires authentication (<code>IsAuthenticated</code>).</p>"},{"location":"draft_contracts/04_generate_draft/#content-type","title":"Content-Type","text":"<p><code>application/json</code></p>"},{"location":"draft_contracts/04_generate_draft/#request-body","title":"Request Body","text":"<pre><code>{\n  \"template_id\": \"69291e28f5e5c1fd74b48165\",\n  \"variables\": {\n    \"landlord_name\": \"John Doe\",\n    \"tenant_name\": \"Acme Pvt Ltd\",\n    \"property_address\": \"Bangalore, India\",\n    \"lease_term\": \"11 months\",\n    \"monthly_rent\": \"50000\",\n    \"currency\": \"USD\",\n    \"security_deposit\": \"150000\",\n    \"start_date\": \"2025-12-01\",\n    \"special_terms\": \"No subletting\"\n  }\n}\n</code></pre>"},{"location":"draft_contracts/04_generate_draft/#success-response-201-created","title":"Success Response \u2014 201 Created","text":"<pre><code>{\n  \"message\": \"Draft contract generated successfully.\",\n  \"contract_id\": \"string\", // stringified MongoDB _id of the created contract draft\n  \"html_content\": \"string\" // rendered HTML of the contract\n}\n</code></pre>"},{"location":"draft_contracts/04_generate_draft/#error-responses","title":"Error Responses","text":""},{"location":"draft_contracts/04_generate_draft/#400-bad-request","title":"400 Bad Request","text":"<ul> <li>Missing organization:</li> </ul> <pre><code>{ \"error\": \"User organization not found.\" }\n</code></pre> <ul> <li>Missing <code>template_id</code>:</li> </ul> <pre><code>{ \"error\": \"template_id is required.\" }\n</code></pre> <ul> <li><code>variables</code> not an object/dict:</li> </ul> <pre><code>{ \"error\": \"variables must be an object/dict.\" }\n</code></pre> <ul> <li>Invalid <code>template_id</code> (not a valid ObjectId):</li> </ul> <pre><code>{ \"error\": \"Invalid template_id.\" }\n</code></pre> <ul> <li>Template has no <code>html_content</code>:</li> </ul> <pre><code>{ \"error\": \"Template does not have html_content.\" }\n</code></pre> <ul> <li>Rendering left placeholders (missing variables) \u2014 includes <code>missing</code> list:</li> </ul> <pre><code>{\n  \"error\": \"Missing variables for template rendering.\",\n  \"missing\": [\"var1\", \"var2\"]\n}\n</code></pre> <ul> <li>Template rendering failed (Jinja TemplateError) \u2014 includes <code>details</code>:</li> </ul> <pre><code>{ \"error\": \"Template rendering failed.\", \"details\": \"error details string\" }\n</code></pre>"},{"location":"draft_contracts/04_generate_draft/#404-not-found","title":"404 Not Found","text":"<ul> <li>Template not found:</li> </ul> <pre><code>{ \"error\": \"Template not found.\" }\n</code></pre>"},{"location":"draft_contracts/04_generate_draft/#500-internal-server-error","title":"500 Internal Server Error","text":"<ul> <li>Failed to save contract draft:</li> </ul> <pre><code>{ \"error\": \"Failed to save contract draft.\" }\n</code></pre> <ul> <li>Generic rendering failure:</li> </ul> <pre><code>{ \"error\": \"Template rendering failed.\" }\n</code></pre>"},{"location":"public_api/extractor/","title":"Lease Extraction API Documentation","text":""},{"location":"public_api/extractor/#overview","title":"Overview","text":"<p>The Lease Extraction API is designed to process commercial lease PDF documents and extract key clauses. The API uses a POST request to submit a PDF file or URL for processing and a GET request to retrieve the extraction status and results. The extracted data can be used for commercial risk analysis.</p> <p>This API is hosted at https://connectstagingbackend.aviaralabs.com/api/v1/aviara-connect/</p>"},{"location":"public_api/extractor/#endpoints","title":"Endpoints","text":""},{"location":"public_api/extractor/#1-submit-extraction","title":"1. Submit Extraction","text":"<p>Endpoint: <code>/extractor/</code> Method: POST Description: Submits a PDF file for lease clause extraction. The request enqueues a Celery task for asynchronous processing and returns a <code>job_id</code> for tracking.</p> <p>Request:</p> <ul> <li>Content-Type: <code>multipart/form-data</code></li> <li>Parameters:</li> <li><code>pdf</code> (file): A PDF file containing the lease document. Must be one of <code>application/pdf</code>, <code>application/x-pdf</code>, or <code>application/octet-stream</code>.</li> <li><code>pages_per_batch</code> (integer, optional): Number of pages to process per batch. Default is 30.</li> <li><code>max_page_chars</code> (integer, optional): Maximum characters per page for processing. Default is 3000.</li> <li>Constraints:</li> <li>Supported file types: PDF only.</li> </ul> <p>Response:</p> <ul> <li>Status: <code>202 Accepted</code></li> <li>Body:</li> </ul> <pre><code>{\n  \"job_id\": \"985b898f-3d1c-45fd-a810-79db39382d15\",\n  \"status\": \"queued\"\n}\n</code></pre> <ul> <li>Error Responses:</li> <li><code>400 Bad Request</code>: Invalid input (e.g., missing <code>pdf</code>).</li> <li><code>413 Request Entity Too Large</code>: PDF exceeds size limit (e.g. above <code>200mb</code>)</li> <li><code>415 Unsupported Media Type</code>: File type is not PDF.</li> <li><code>500 Internal Server Error</code>: Unexpected server error.</li> </ul> <p>Example:</p> <pre><code>curl -X POST https://connectstagingbackend.aviaralabs.com/api/v1/aviara-connect/extractor/ \\\n  -F \"pdf=@lease_document.pdf\" \\\n</code></pre>"},{"location":"public_api/extractor/#2-extraction-status","title":"2. Extraction Status","text":"<p>Endpoint: <code>/extractor/&lt;job_id&gt;/</code> Method: GET Description: Retrieves the status and results of a lease extraction task identified by <code>job_id</code>.</p> <p>Request:</p> <ul> <li>Path Parameter:</li> <li><code>job_id</code> (string): The unique identifier of the extraction task (UUID format).</li> <li>Query Parameters: None.</li> </ul> <p>Response:</p> <ul> <li>Status: <code>200 OK</code> (or <code>202 Accepted</code> for <code>PENDING</code> state)</li> <li> <p>Body:</p> </li> <li> <p>Common fields:     <code>json     {       \"job_id\": \"985b898f-3d1c-45fd-a810-79db39382d15\",       \"status\": \"PENDING|STARTED|PROGRESS|RETRY|SUCCESS|FAILURE\"     }</code></p> </li> <li> <p>For <code>SUCCESS</code>:</p> <p><code>json {   \"job_id\": \"985b898f-3d1c-45fd-a810-79db39382d15\",   \"status\": \"SUCCESS\",   \"result\": {     \"Financial Clauses\": { ... },     \"Build-Out &amp; Premises Clauses\": { ... },     \"Operational Clauses\": { ... },     \"Legal &amp; Liability Clauses\": { ... },     \"Flexibility &amp; Exit Clauses\": { ... },     \"Operational Clauses\": { ... },   } }</code></p> </li> <li> <p>For <code>PROGRESS</code> or <code>STARTED</code>:     <code>json     {       \"job_id\": \"985b898f-3d1c-45fd-a810-79db39382d15\",       \"status\": \"PROGRESS\",       \"progress\": 0.5,       \"current_batch\": 2,       \"total_batches\": 4,       \"pages_loaded\": 60,       \"nonempty_pages\": 50,       \"message\": \"Processing batch 2 of 4\",       \"events\": [\"Started processing\", \"Batch 1 completed\"]     }</code></p> </li> <li> <p>For <code>FAILURE</code>:     <code>json     {       \"job_id\": \"985b898f-3d1c-45fd-a810-79db39382d15\",       \"status\": \"FAILURE\",       \"error\": \"Error message\"     }</code></p> </li> <li> <p>Error Responses:</p> </li> <li><code>404 Not Found</code>: Invalid or expired <code>job_id</code>.</li> <li><code>500 Internal Server Error</code>: Unexpected server error.</li> </ul> <p>Example:</p> <pre><code>curl -X GET https://connectstagingbackend.aviaralabs.com/api/v1/aviara-connect/extractor/985b898f-3d1c-45fd-a810-79db39382d15/\n</code></pre>"},{"location":"public_api/extractor/#authentication","title":"Authentication","text":"<ul> <li>Current: No authentication required (<code>permissions.AllowAny</code>).</li> </ul>"}]}